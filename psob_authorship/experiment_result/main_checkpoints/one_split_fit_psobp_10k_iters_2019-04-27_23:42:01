Config: {'experiment_name': 'one_split_fit_psobp', 'experiment_notes': 'compare SGD with Adam when pso iters = 10k', 'number_of_authors': 40, 'labels_features_common_name': '../calculated_features/extracted_for_each_file', 'epochs': 10000, 'batch_size': 32, 'early_stopping_rounds': 500, 'lr': 0.001, 'n_splits': 10, 'random_state': 4562, 'criterion': CrossEntropyLoss(), 'optimizer': <class 'torch.optim.adam.Adam'>, 'shuffle': True, 'trainers_to_use': ['pso', 'bp'], 'pso_options': {'c1': 1.49, 'c2': 1.49, 'w': (0.4, 0.9), 'use_pyswarms': False, 'particle_clamp': (-1, 1), 'use_particle_clamp_each_iteration': False, 'unchanged_iterations_stop': 10000, 'use_only_early_stopping': False}, 'pso_velocity_clamp': (-1, 1), 'n_particles': 100, 'pso_iters': 10000, 'pso_optimizer': <class 'psob_authorship.pso.PSO.PSO'>, 'cv': StratifiedKFold(n_splits=10, random_state=4562, shuffle=True)}
INITIAL DATA: accuracy 0.021739130434782608, train loss 3.6309494972229004, test loss 3.6335628032684326
CHECKPOINT each 100th ITERATION 0. Train Loss: 9.411121, Test Loss: 9.743815422058105, Test Accuracy: 0.16459627329192547
CHECKPOINT each 100th ITERATION 100. Train Loss: 9.411121, Test Loss: 9.743815422058105, Test Accuracy: 0.16459627329192547
CHECKPOINT each 100th ITERATION 200. Train Loss: 9.411121, Test Loss: 9.743815422058105, Test Accuracy: 0.16459627329192547
CHECKPOINT each 100th ITERATION 300. Train Loss: 9.411121, Test Loss: 9.743815422058105, Test Accuracy: 0.16459627329192547
CHECKPOINT each 100th ITERATION 400. Train Loss: 8.774751, Test Loss: 9.155322074890137, Test Accuracy: 0.2422360248447205
CHECKPOINT each 100th ITERATION 500. Train Loss: 8.314461, Test Loss: 8.690424919128418, Test Accuracy: 0.2329192546583851
CHECKPOINT each 100th ITERATION 600. Train Loss: 7.878348, Test Loss: 7.974034786224365, Test Accuracy: 0.2546583850931677
CHECKPOINT each 100th ITERATION 700. Train Loss: 7.51896, Test Loss: 7.708685874938965, Test Accuracy: 0.2919254658385093
CHECKPOINT each 100th ITERATION 800. Train Loss: 7.5168114, Test Loss: 7.704201698303223, Test Accuracy: 0.2919254658385093
CHECKPOINT each 100th ITERATION 900. Train Loss: 7.5168104, Test Loss: 7.704202175140381, Test Accuracy: 0.2919254658385093
CHECKPOINT each 100th ITERATION 1000. Train Loss: 7.288451, Test Loss: 7.637969970703125, Test Accuracy: 0.2888198757763975
CHECKPOINT each 100th ITERATION 1100. Train Loss: 6.835991, Test Loss: 7.090028762817383, Test Accuracy: 0.2981366459627329
CHECKPOINT each 100th ITERATION 1200. Train Loss: 6.522683, Test Loss: 6.903843402862549, Test Accuracy: 0.2795031055900621
CHECKPOINT each 100th ITERATION 1300. Train Loss: 6.282795, Test Loss: 6.583984375, Test Accuracy: 0.30124223602484473
CHECKPOINT each 100th ITERATION 1400. Train Loss: 6.125732, Test Loss: 6.4616379737854, Test Accuracy: 0.3167701863354037
CHECKPOINT each 100th ITERATION 1500. Train Loss: 5.9299154, Test Loss: 6.410107612609863, Test Accuracy: 0.32608695652173914
CHECKPOINT each 100th ITERATION 1600. Train Loss: 5.677806, Test Loss: 6.298762321472168, Test Accuracy: 0.2919254658385093
CHECKPOINT each 100th ITERATION 1700. Train Loss: 5.3720827, Test Loss: 6.0335693359375, Test Accuracy: 0.3167701863354037
CHECKPOINT each 100th ITERATION 1800. Train Loss: 5.172488, Test Loss: 5.757817268371582, Test Accuracy: 0.35093167701863354
CHECKPOINT each 100th ITERATION 1900. Train Loss: 4.8957963, Test Loss: 5.481584072113037, Test Accuracy: 0.37577639751552794
CHECKPOINT each 100th ITERATION 2000. Train Loss: 4.6254315, Test Loss: 5.280313014984131, Test Accuracy: 0.37888198757763975
CHECKPOINT each 100th ITERATION 2100. Train Loss: 4.280458, Test Loss: 4.993981838226318, Test Accuracy: 0.38198757763975155
CHECKPOINT each 100th ITERATION 2200. Train Loss: 3.9811566, Test Loss: 4.702182769775391, Test Accuracy: 0.43167701863354035
CHECKPOINT each 100th ITERATION 2300. Train Loss: 3.9218273, Test Loss: 4.668532371520996, Test Accuracy: 0.41304347826086957
CHECKPOINT each 100th ITERATION 2400. Train Loss: 3.7319267, Test Loss: 4.516365051269531, Test Accuracy: 0.4192546583850932
CHECKPOINT each 100th ITERATION 2500. Train Loss: 3.567904, Test Loss: 4.275019645690918, Test Accuracy: 0.43478260869565216
CHECKPOINT each 100th ITERATION 2600. Train Loss: 3.4032533, Test Loss: 4.176218032836914, Test Accuracy: 0.43167701863354035
CHECKPOINT each 100th ITERATION 2700. Train Loss: 3.2308495, Test Loss: 4.007683277130127, Test Accuracy: 0.453416149068323
CHECKPOINT each 100th ITERATION 2800. Train Loss: 3.100534, Test Loss: 3.8517262935638428, Test Accuracy: 0.4503105590062112
CHECKPOINT each 100th ITERATION 2900. Train Loss: 2.9868433, Test Loss: 3.7530393600463867, Test Accuracy: 0.42857142857142855
CHECKPOINT each 100th ITERATION 3000. Train Loss: 2.8268898, Test Loss: 3.563774824142456, Test Accuracy: 0.4782608695652174
CHECKPOINT each 100th ITERATION 3100. Train Loss: 2.670445, Test Loss: 3.5062286853790283, Test Accuracy: 0.45962732919254656
CHECKPOINT each 100th ITERATION 3200. Train Loss: 2.5613806, Test Loss: 3.494859457015991, Test Accuracy: 0.4937888198757764
CHECKPOINT each 100th ITERATION 3300. Train Loss: 2.4412234, Test Loss: 3.3135592937469482, Test Accuracy: 0.4968944099378882
CHECKPOINT each 100th ITERATION 3400. Train Loss: 2.3402777, Test Loss: 3.1884992122650146, Test Accuracy: 0.5124223602484472
CHECKPOINT each 100th ITERATION 3500. Train Loss: 2.256375, Test Loss: 3.0408034324645996, Test Accuracy: 0.5403726708074534
CHECKPOINT each 100th ITERATION 3600. Train Loss: 2.1931043, Test Loss: 2.947646141052246, Test Accuracy: 0.5372670807453416
CHECKPOINT each 100th ITERATION 3700. Train Loss: 2.1110697, Test Loss: 2.866481065750122, Test Accuracy: 0.5372670807453416
CHECKPOINT each 100th ITERATION 3800. Train Loss: 2.045335, Test Loss: 2.7860424518585205, Test Accuracy: 0.546583850931677
CHECKPOINT each 100th ITERATION 3900. Train Loss: 1.9920003, Test Loss: 2.774974822998047, Test Accuracy: 0.5403726708074534
CHECKPOINT each 100th ITERATION 4000. Train Loss: 1.9439324, Test Loss: 2.7480385303497314, Test Accuracy: 0.5527950310559007
CHECKPOINT each 100th ITERATION 4100. Train Loss: 1.9177085, Test Loss: 2.7307522296905518, Test Accuracy: 0.5527950310559007
CHECKPOINT each 100th ITERATION 4200. Train Loss: 1.8915493, Test Loss: 2.7221295833587646, Test Accuracy: 0.562111801242236
CHECKPOINT each 100th ITERATION 4300. Train Loss: 1.8669269, Test Loss: 2.705432653427124, Test Accuracy: 0.562111801242236
CHECKPOINT each 100th ITERATION 4400. Train Loss: 1.8285164, Test Loss: 2.6962664127349854, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 4500. Train Loss: 1.7793955, Test Loss: 2.67513108253479, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 4600. Train Loss: 1.7498902, Test Loss: 2.6551337242126465, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 4700. Train Loss: 1.7242917, Test Loss: 2.6387581825256348, Test Accuracy: 0.5683229813664596
CHECKPOINT each 100th ITERATION 4800. Train Loss: 1.7005385, Test Loss: 2.6370620727539062, Test Accuracy: 0.562111801242236
CHECKPOINT each 100th ITERATION 4900. Train Loss: 1.68187, Test Loss: 2.6050267219543457, Test Accuracy: 0.562111801242236
CHECKPOINT each 100th ITERATION 5000. Train Loss: 1.6754344, Test Loss: 2.604170799255371, Test Accuracy: 0.5527950310559007
CHECKPOINT each 100th ITERATION 5100. Train Loss: 1.6732588, Test Loss: 2.602997064590454, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 5200. Train Loss: 1.6729786, Test Loss: 2.6012141704559326, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 5300. Train Loss: 1.6717819, Test Loss: 2.605543613433838, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 5400. Train Loss: 1.6717806, Test Loss: 2.605534791946411, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 5500. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 5600. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 5700. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 5800. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 5900. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 6000. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 6100. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 6200. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 6300. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 6400. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 6500. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 6600. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 6700. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 6800. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 6900. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 7000. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 7100. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 7200. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 7300. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 7400. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 7500. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 7600. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 7700. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 7800. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 7900. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 8000. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 8100. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 8200. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 8300. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 8400. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 8500. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 8600. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 8700. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 8800. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 8900. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 9000. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 9100. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 9200. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 9300. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 9400. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 9500. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 9600. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 9700. Train Loss: 1.6717806, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 9800. Train Loss: 1.6717805, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
CHECKPOINT each 100th ITERATION 9900. Train Loss: 1.6717805, Test Loss: 2.605534553527832, Test Accuracy: 0.5559006211180124
Loss after PSO optimizing = 1.6717805
Train accuracy of the network: 1791 / 2700 = 66 %
Final accuracy of the network: 179 / 322 = 55 %
Correct labels / labels for each author:
tensor([[ 3.,  7.],
        [12., 14.],
        [ 3.,  4.],
        [ 2., 10.],
        [ 5., 10.],
        [72., 72.],
        [ 5.,  6.],
        [ 2.,  3.],
        [ 0.,  3.],
        [ 4.,  6.],
        [ 0.,  5.],
        [ 6.,  9.],
        [ 2.,  3.],
        [ 3.,  7.],
        [ 0.,  2.],
        [ 1.,  8.],
        [ 4.,  8.],
        [ 2.,  7.],
        [ 0.,  4.],
        [ 1., 10.],
        [ 3.,  5.],
        [ 0.,  2.],
        [ 0.,  5.],
        [ 3.,  3.],
        [ 1.,  7.],
        [ 1.,  8.],
        [ 0.,  6.],
        [ 1.,  4.],
        [ 6., 10.],
        [ 0.,  2.],
        [ 1.,  3.],
        [ 3.,  5.],
        [14., 21.],
        [ 2.,  3.],
        [ 7., 15.],
        [ 2.,  4.],
        [ 1.,  9.],
        [ 2.,  3.],
        [ 3.,  4.],
        [ 2.,  5.]])
END OF PSO TRAINING
INITIAL DATA: accuracy 0.5559006211180124, train loss 1.6717804670333862, test loss 2.605534553527832
CHECKPOINT EACH 100th EPOCH 0: current accuracy 0.593167701863354 , best 0.593167701863354, train loss 1.5516440868377686, test loss 2.501192569732666
CHECKPOINT EACH 100th EPOCH 100: current accuracy 0.6987577639751553 , best 0.7080745341614907, train loss 0.1402253657579422, test loss 1.6652002334594727
CHECKPOINT EACH 100th EPOCH 200: current accuracy 0.7298136645962733 , best 0.7453416149068323, train loss 0.03408414497971535, test loss 1.7031663656234741
CHECKPOINT EACH 100th EPOCH 300: current accuracy 0.7329192546583851 , best 0.7453416149068323, train loss 0.010646222159266472, test loss 1.9380987882614136
CHECKPOINT EACH 100th EPOCH 400: current accuracy 0.7391304347826086 , best 0.7453416149068323, train loss 0.004360591992735863, test loss 2.2149972915649414
CHECKPOINT EACH 100th EPOCH 500: current accuracy 0.7422360248447205 , best 0.7484472049689441, train loss 0.0027573592960834503, test loss 2.501671075820923
CHECKPOINT EACH 100th EPOCH 600: current accuracy 0.7360248447204969 , best 0.7515527950310559, train loss 0.0014241087483242154, test loss 2.7121286392211914
CHECKPOINT EACH 100th EPOCH 700: current accuracy 0.7360248447204969 , best 0.7546583850931677, train loss 0.0007128821453079581, test loss 2.953766345977783
CHECKPOINT EACH 100th EPOCH 800: current accuracy 0.7422360248447205 , best 0.7546583850931677, train loss 0.0026541275437921286, test loss 3.1228904724121094
CHECKPOINT EACH 100th EPOCH 900: current accuracy 0.7360248447204969 , best 0.7546583850931677, train loss 0.00033876736415550113, test loss 3.377074718475342
CHECKPOINT EACH 100th EPOCH 1000: current accuracy 0.7360248447204969 , best 0.7546583850931677, train loss 0.0005442792316898704, test loss 3.6110029220581055
CHECKPOINT EACH 100th EPOCH 1100: current accuracy 0.7360248447204969 , best 0.7546583850931677, train loss 0.0001230261113960296, test loss 3.8170928955078125
On epoch 1150 training was early stopped
Finished training
Best accuracy: 0.7546583850931677
Accuracy of the last validation of the network: 237 / 322 = 73 %
Correct labels / labels for each author of last validation:
tensor([[ 5.,  7.],
        [13., 14.],
        [ 4.,  4.],
        [ 6., 10.],
        [ 6., 10.],
        [72., 72.],
        [ 6.,  6.],
        [ 2.,  3.],
        [ 0.,  3.],
        [ 5.,  6.],
        [ 1.,  5.],
        [ 9.,  9.],
        [ 3.,  3.],
        [ 5.,  7.],
        [ 1.,  2.],
        [ 3.,  8.],
        [ 5.,  8.],
        [ 6.,  7.],
        [ 1.,  4.],
        [ 2., 10.],
        [ 4.,  5.],
        [ 0.,  2.],
        [ 2.,  5.],
        [ 3.,  3.],
        [ 5.,  7.],
        [ 4.,  8.],
        [ 6.,  6.],
        [ 3.,  4.],
        [ 7., 10.],
        [ 1.,  2.],
        [ 1.,  3.],
        [ 3.,  5.],
        [17., 21.],
        [ 2.,  3.],
        [10., 15.],
        [ 2.,  4.],
        [ 2.,  9.],
        [ 2.,  3.],
        [ 4.,  4.],
        [ 4.,  5.]])
Execution time: 0:53:31.134427
